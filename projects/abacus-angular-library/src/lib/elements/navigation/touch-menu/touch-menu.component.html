<nav class="navbar" role="navigation" aria-label="main navigation" #menu>
  <div>
    <div
      class="dropdown is-right"
      [ngClass]="{ 'is-active': showUserMenu }"
      *ngIf="currentUser"
    >
      <div class="user-box">
        <a
          [routerLink]="['/collaborateurs', currentUser.id, 'edit']"
          aria-haspopup="true"
          aria-controls="dropdown-menu2"
        >
          <abc-image
            [path]="currentUser.image"
            replacement="/assets/images/avatar.svg"
            [title]="currentUser.name"
            [alt]="currentUser.name"
            className="avatar-sm"
          >
          </abc-image>
        </a>
      </div>
    </div>
    <a class="logo" routerLink="/" (click)="closeMenu()">
      <img src="/assets/images/logo.svg" width="84" height="32" />
    </a>

    <a
      role="button"
      class="navbar-burger burger"
      aria-label="menu"
      aria-expanded="false"
      data-target="navbarBasicExample"
      (click)="toggleMenu()"
    >
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="hiding-layer" #hidingLayer></div>
  <div class="navbar-menu" id="create-dropdown" #menuItemsEl>
    <div class="navbar-end">
      <ul class="menu-list m-t-gutter menu-list--top">
        <ng-container *ngFor="let menuItem of menuItems; let i = index">
          <li *abcHasPermission="{ requireOr: menuItem.permissionsOr }">
            <!-- Direct link -->
            <ng-container *ngIf="menuItem.routePath">
              <a [routerLink]="menuItem.routePath" routerLinkActive="is-active">
                <i class="icon m-r-md is-size-4" [ngClass]="menuItem.icon"></i>
                <span class="p-l-xs">{{ menuItem.label }}</span>
              </a>
            </ng-container>

            <!-- Sub list -->
            <ng-container *ngIf="menuItem.items && menuItem.items.length">
              <a
                (click)="toggleAccordion('accordion-' + i)"
                class="has-submenu"
              >
                <span>
                  <i
                    class="icon m-r-md is-size-4"
                    [ngClass]="menuItem.icon"
                  ></i>
                  <span class="p-l-xs">{{ menuItem.label }}</span>
                </span>
                <i
                  class="icon icon-chevron-down m-r-xs"
                  *ngIf="activeAccordion !== 'accordion-' + i"
                ></i>
                <i
                  class="icon icon-chevron-up m-r-xs"
                  *ngIf="activeAccordion === 'accordion-' + i"
                ></i>
              </a>

              <ul *ngIf="activeAccordion === 'accordion-' + i">
                <ng-container *ngFor="let subItem of menuItem.items">
                  <li *abcHasPermission="{ requireOr: subItem.permissionsOr }">
                    <a
                      [routerLink]="subItem.routePath"
                      routerLinkActive="is-active"
                    >
                      <span class="p-l-xs">{{ subItem.label }}</span>
                    </a>
                  </li>
                </ng-container>
              </ul>
            </ng-container>
          </li>
        </ng-container>
      </ul>
    </div>
  </div>
</nav>
